{% extends 'blog/base.html' %}

{%block content%}

<h2>{{post.title}}</h2>
<p>{{post.content}}</p>
<p>Author: {{post.author}}</p>
<a href="{% url 'post-update' post.pk %}">Edit</a>
<a href="{% url 'post-delete' post.pk %}">Delete</a>
<hr>
<h3>Comments</h3>
{%for comment in post.comments.all%}
    <p><strong>{{comment.author}}</strong>: {{comment.content}}</p>
    <small>{{comment.created_at}}</small>
    {%if user == comment.author%}
        <br>
        <a href="{%url 'comment-update' comment.pk %}">Edit</a>
        <a href="{%url 'comment-delete' comment.pk %}">Delete</a>
    {%endif%}
    <hr>
{%empty%}
<p>No comments yet.</p>
{%endfor%}

{%if user.is_authenticated%}
    <h3>Add a comment</h3>
    <form method="post" action="{% url 'comment-create' post.pk %}">
        {% csrf_token %}
        {{form.as_p}}
        <button type="submit">Post Comment</button>
    </form>
{%else%}
    <p>You must be logged in to add a comment.</p>
{%endif%}

<p>Tags:
{% for tag in post.tags.all %}
    <a href="{% url 'posts-by-tag' tag.slug %}">#{{tag.slug}}</a>
{%empty%}
 No Tags
{%endfor%}
</p>

{%endblock%}